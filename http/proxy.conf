server {
    listen 80;
    return 301 https://$host$request_uri;
}

server {
    listen      443;
    server_name ftp.harukasan.org;

    ssl                         on;
    ssl_session_cache           builtin:1000 shared:SSL:10m;
    ssl_protocols               TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4;
    ssl_prefer_server_ciphers   on;
    ssl_certificate             /etc/ssl/certs-startcom/1_ftp.harukasan.org_bundle.crt;
    ssl_certificate_key         /etc/ssl/private/harukasan.org.key;

    access_log  /var/log/nginx/access_ftp.log main;
    error_log   /var/log/nginx/error_ftp.log error;

    location / {
        proxy_set_header    Host $host;
        proxy_set_header    X-Real-IP $remote_addr;
        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header    X-Forwarded-Proto $scheme;
        proxy_read_timeout  90;
        proxy_pass          https://ftp.harukasan;
        proxy_redirect      https://ftp.harukasan https://ftp.harukasan.org;
    }
}

server {
    listen      443;
    server_name home.harukasan.org;

    ssl                         on;
    ssl_session_cache           builtin:1000 shared:SSL:10m;
    ssl_protocols               TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4;
    ssl_prefer_server_ciphers   on;
    ssl_certificate             /etc/ssl/certs-startcom/1_home.harukasan.org_bundle.crt;
    ssl_certificate_key         /etc/ssl/private/harukasan.org.key;

    access_log  /var/log/nginx/access_home.log main;
    error_log   /var/log/nginx/error_home.log error;

    location / {
        proxy_set_header    Host $host;
        proxy_set_header    X-Real-IP $remote_addr;
        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header    X-Forwarded-Proto $scheme;
        proxy_read_timeout  90;
        proxy_pass          https://aws.harukasan;
        proxy_redirect      https://aws.harukasan https://home.harukasan.org;
    }
}

server {
    listen      443;
    server_name pmaws.harukasan.org;

    ssl                         on;
    ssl_session_cache           builtin:1000 shared:SSL:10m;
    ssl_protocols               TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4;
    ssl_prefer_server_ciphers   on;
    ssl_certificate             /etc/ssl/certs-harukasan/pmaws.harukasan.org.chained.cert.pem;
    ssl_certificate_key         /etc/ssl/private/pmaws.harukasan.org.key.pem;

    access_log  /var/log/nginx/access_pmaws.log main;
    error_log   /var/log/nginx/error_pmaws.log error;

    location / {
        proxy_set_header    Host $host;
        proxy_set_header    X-Real-IP $remote_addr;
        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header    X-Forwarded-Proto $scheme;
        proxy_read_timeout  90;
        proxy_pass          https://pmaws.harukasan;
        proxy_redirect      https://pmaws.harukasan https://pmaws.harukasan.org;
    }
}

server {
    listen      443;
    server_name nws.harukasan.org;

    ssl                         on;
    ssl_session_cache           builtin:1000 shared:SSL:10m;
    ssl_protocols               TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4;
    ssl_prefer_server_ciphers   on;
    ssl_certificate             /etc/ssl/certs-startcom/1_nws.harukasan.org_bundle.crt;
    ssl_certificate_key         /etc/ssl/private/harukasan.org.key;

    access_log  /var/log/nginx/access_nws.log main;
    error_log   /var/log/nginx/error_nws.log error;

    location / {
        proxy_set_header    Host $host;
        proxy_set_header    X-Real-IP $remote_addr;
        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header    X-Forwarded-Proto $scheme;
        proxy_read_timeout  90;
        proxy_pass          https://nws.harukasan;
        proxy_redirect      https://nws.harukasan https://nws.harukasan.org;
    }
}
